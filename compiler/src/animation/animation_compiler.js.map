{"version":3,"file":"animation_compiler.js","sourceRoot":"","sources":["../../../../../modules/@angular/compiler/src/animation/animation_compiler.ts"],"names":[],"mappings":"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","sourcesContent":["import {BaseException} from '../facade/exceptions';\nimport {ListWrapper, Map, StringMapWrapper} from '../facade/collection';\nimport {isPresent, isBlank, isArray} from '../facade/lang';\n\nimport {Identifiers} from '../identifiers';\nimport * as o from '../output/output_ast';\n\nimport {AUTO_STYLE} from '@angular/core';\nimport {ANY_STATE, EMPTY_STATE} from '../../core_private';\n\nimport {\n  AnimationParseError,\n  ParsedAnimationResult,\n  parseAnimationEntry\n} from './animation_parser';\n\nimport {CompileDirectiveMetadata} from \"../compile_metadata\";\n\nimport {\n  AnimationAst,\n  AnimationEntryAst,\n  AnimationStateAst,\n  AnimationStateDeclarationAst,\n  AnimationStateTransitionAst,\n  AnimationKeyframeAst,\n  AnimationStylesAst,\n  AnimationSequenceAst,\n  AnimationGroupAst,\n  AnimationStepAst,\n  AnimationAstVisitor\n} from './animation_ast';\n\nexport class CompiledAnimation {\n  constructor(public name: string, public fnStatement: o.Statement, public fnVariable: o.Expression) {}\n}\n\nexport class AnimationCompiler {\n  compileComponent(component: CompileDirectiveMetadata): CompiledAnimation[] {\n    var compiledAnimations: CompiledAnimation[] = [];\n    var index = 0;\n    component.template.animations.forEach(entry => {\n      var result = parseAnimationEntry(entry);\n      if (result.errors.length > 0) {\n        var errorMessage = '';\n        result.errors.forEach((error: AnimationParseError) => { errorMessage += \"\\n- \" + error.msg; });\n        // todo (matsko): include the component name when throwing\n        throw new BaseException(\n          `Unable to parse the animation sequence for \"${entry.name}\" due to the following errors: ` +\n          errorMessage);\n      }\n\n      var factoryName = `${component.type.name}_${entry.name}_${index}`;\n      index++;\n\n      var visitor = new _AnimationBuilder(entry.name, factoryName);\n      compiledAnimations.push(visitor.build(result.ast));\n    });\n    return compiledAnimations;\n  }\n}\n\nenum _AnimationStyleStepState {\n  FirstStateChangeStartingStyles,\n  FinalStateChangeStartingStyles,\n  FinalStateChangeKeyframeStyles,\n  InsideKeyframeSequence,\n  NormalStyles\n}\n\nvar _ANIMATION_VOID_STATE_VALUE = o.literal('void');\nvar _ANIMATION_STYLE_UTIL = o.importExpr(Identifiers.AnimationStyleUtil);\nvar _ANIMATION_FACTORY_ELEMENT_VAR = o.variable('element');\nvar _ANIMATION_FACTORY_VIEW_VAR = o.variable('view');\nvar _ANIMATION_FACTORY_RENDERER_VAR = _ANIMATION_FACTORY_VIEW_VAR.prop('renderer');\nvar _ANIMATION_CURRENT_STATE_VAR = o.variable('currentState');\nvar _ANIMATION_NEXT_STATE_VAR = o.variable('nextState');\nvar _ANIMATION_PLAYER_VAR = o.variable('player');\nvar _ANIMATION_START_STATE_STYLES_VAR = o.variable('startStateStyles');\nvar _ANIMATION_FINAL_STATE_STYLES_VAR = o.variable('finalStateStyles');\nvar _ANIMATION_STYLES_LOOKUP = o.variable('animationStateStyles');\nvar _ANIMATION_COLLECTED_STYLES = o.variable('collectedStyles');\n\nclass _AnimationBuilder implements AnimationAstVisitor {\n  constructor(public animationName: string, public factoryName: string) {}\n\n  visitAnimationStyles(ast: AnimationStylesAst,\n                       context: _AnimationBuilderContext): o.Expression {\n    var stylesArr = [];\n    if (context.styleState == _AnimationStyleStepState.FirstStateChangeStartingStyles) {\n      stylesArr.push(_ANIMATION_START_STATE_STYLES_VAR);\n    }\n\n    ast.styles.forEach(entry => {\n      stylesArr.push(o.literalMap(StringMapWrapper.keys(entry).map(key => [key, o.literal(entry[key])])));\n    });\n\n    return o.importExpr(Identifiers.AnimationStyles).instantiate([\n      _ANIMATION_STYLE_UTIL.callMethod('collectAndResolveStyles', [\n        _ANIMATION_COLLECTED_STYLES,\n        o.literalArr(stylesArr)\n      ])\n    ]);\n  }\n\n  visitAnimationKeyframe(ast: AnimationKeyframeAst,\n                         context: _AnimationBuilderContext): o.Expression {\n    return o.importExpr(Identifiers.AnimationKeyframe).instantiate([\n      o.literal(ast.offset),\n      ast.styles.visit(this, context)\n    ]);\n  }\n\n  visitAnimationStep(ast: AnimationStepAst, context: _AnimationBuilderContext): o.Expression {\n    if (!isPresent(context.finalAnimateStepAst) && ast.keyframes.length > 0) {\n      context.finalAnimateStepAst = ast;\n      context.styleState = _AnimationStyleStepState.FirstStateChangeStartingStyles;\n    }\n\n    if (context.finalAnimateStepAst === ast && ast.keyframes[0].styles.styles.length == 1) {\n      let astStyles = ast.keyframes[0].styles.styles[0];\n      if (StringMapWrapper.isEmpty(astStyles)) {\n        return this._visitFinalAnimationStep(ast, context);\n      }\n    }\n\n    var startingStylesExpr = ast.startingStyles.visit(this, context);\n\n    var totalKeyframes = ast.keyframes.length;\n    if (totalKeyframes > 2) {\n      context.styleState = _AnimationStyleStepState.InsideKeyframeSequence;\n    } else if (context.styleState == _AnimationStyleStepState.FirstStateChangeStartingStyles) {\n      context.styleState = _AnimationStyleStepState.NormalStyles;\n    }\n\n    var keyframes = ast.keyframes.map(keyframeEntry => keyframeEntry.visit(this, context));\n\n    context.styleState = _AnimationStyleStepState.NormalStyles;\n\n    var keyframesExpr = o.literalArr(keyframes);\n    return this._callAnimateMethod(ast, startingStylesExpr, keyframesExpr);\n  }\n\n  _visitFinalAnimationStep(ast: AnimationStepAst,\n                         context: _AnimationBuilderContext): o.Expression {\n    context.styleState = _AnimationStyleStepState.FinalStateChangeStartingStyles;\n    var startingStylesExpr = ast.startingStyles.visit(this, context);\n\n    context.styleState = _AnimationStyleStepState.FinalStateChangeKeyframeStyles;\n    var keyframeExpressions = ast.keyframes.map(keyframe => {\n      return keyframe.visit(this, context);\n    });\n\n    context.styleState = _AnimationStyleStepState.FinalStateChangeKeyframeStyles;\n    var keyframesExpr = _ANIMATION_STYLE_UTIL.callMethod('balanceKeyframes', [\n      _ANIMATION_COLLECTED_STYLES,\n      _ANIMATION_FINAL_STATE_STYLES_VAR,\n      o.literalArr(keyframeExpressions)\n    ]);\n\n    return this._callAnimateMethod(ast, startingStylesExpr, keyframesExpr);\n  }\n\n  _callAnimateMethod(ast: AnimationStepAst, startingStylesExpr, keyframesExpr) {\n    return _ANIMATION_FACTORY_RENDERER_VAR.callMethod('animate', [\n      _ANIMATION_FACTORY_ELEMENT_VAR,\n      startingStylesExpr,\n      keyframesExpr,\n      o.literal(ast.duration),\n      o.literal(ast.delay),\n      o.literal(ast.easing)\n    ]);\n  }\n\n  visitAnimationSequence(ast: AnimationSequenceAst,\n                         context: _AnimationBuilderContext): o.Expression {\n    if (!isPresent(context.finalAnimateStepAst)) {\n      context.finalAnimateStepAst = ast.steps[ast.steps.length - 1];\n      context.styleState = _AnimationStyleStepState.FirstStateChangeStartingStyles;\n    }\n\n    var playerExprs = ast.steps.map(step => step.visit(this, context));\n    return o.importExpr(Identifiers.AnimationSequencePlayer).instantiate([\n      o.literalArr(playerExprs)]);\n  }\n\n  visitAnimationGroup(ast: AnimationGroupAst, context: _AnimationBuilderContext): o.Expression {\n    var playerExprs = ast.steps.map(step => step.visit(this, context));\n    return o.importExpr(Identifiers.AnimationGroupPlayer).instantiate([\n      o.literalArr(playerExprs)]);\n  }\n\n  visitAnimationStateDeclaration(ast: AnimationStateDeclarationAst, context: _AnimationBuilderContext): void {\n    var flatStyles: {[key: string]: string|number} = {};\n    ast.styles.styles.forEach(entry => {\n      StringMapWrapper.forEach(entry, (value, key) => {\n        flatStyles[key] = value;\n      });\n    });\n    context.stateMap.registerState(ast.stateName, flatStyles);\n  }\n\n  visitAnimationStateTransition(ast: AnimationStateTransitionAst, context: _AnimationBuilderContext): any {\n    context.finalAnimateStepAst = null;\n    var playerExpr = ast.animation.visit(this, context);\n\n    var precondition = _ANIMATION_PLAYER_VAR.equals(o.NULL_EXPR);\n\n    if (ast.fromState == ANY_STATE && ast.toState == ANY_STATE) {\n      context.fullAnyStateDetected = true;\n    } else {\n      if (ast.fromState != ANY_STATE) {\n        precondition = precondition.and(_compareToAnimationStateExpr(_ANIMATION_CURRENT_STATE_VAR, ast.fromState));\n        context.stateMap.registerState(ast.fromState);\n      }\n      if (ast.toState != ANY_STATE) {\n        precondition = precondition.and(_compareToAnimationStateExpr(_ANIMATION_NEXT_STATE_VAR, ast.toState));\n        context.stateMap.registerState(ast.toState);\n      }\n    }\n\n    return new o.IfStmt(precondition, [\n      _ANIMATION_PLAYER_VAR.set(playerExpr).toStmt()\n    ]);\n  }\n\n  visitAnimationEntry(ast: AnimationEntryAst, context: _AnimationBuilderContext): any {\n    var EMPTY_MAP = o.literalMap([]);\n\n    var statements = [];\n    var transitionStatements = [];\n    ast.definitions.forEach(def => {\n      var result = def.visit(this, context);\n      // the declaration state will be applied later\n      if (!(def instanceof AnimationStateDeclarationAst)) {\n        transitionStatements.push(result);\n      }\n    });\n\n    var lookupMap = [];\n    StringMapWrapper.forEach(context.stateMap.states, (value, stateName) => {\n      var variableValue = EMPTY_MAP;\n      if (isPresent(value)) {\n        let styleMap = [];\n        StringMapWrapper.forEach(value, (value, key) => {\n          styleMap.push([key, o.literal(value)]);\n        });\n        variableValue = o.literalMap(styleMap);\n      }\n      lookupMap.push([stateName, variableValue]);\n    });\n\n    statements.push(\n      _ANIMATION_STYLES_LOOKUP.set(\n        o.literalMap(lookupMap)).toDeclStmt());\n\n    statements.push(_ANIMATION_COLLECTED_STYLES.set(EMPTY_MAP).toDeclStmt());\n    statements.push(_ANIMATION_PLAYER_VAR.set(o.NULL_EXPR).toDeclStmt());\n\n    // it's important to normalize the void value as `void` explicitly\n    // so that the styles data can be obtained from the stringmap\n    statements.push(\n      // void => ...\n      new o.IfStmt(_ANIMATION_CURRENT_STATE_VAR.equals(o.importExpr(Identifiers.uninitialized)), [\n        _ANIMATION_CURRENT_STATE_VAR.set(_ANIMATION_VOID_STATE_VALUE).toStmt()\n      ]),\n      // ... => void\n      new o.IfStmt(_ANIMATION_NEXT_STATE_VAR.equals(o.importExpr(Identifiers.uninitialized)), [\n        _ANIMATION_NEXT_STATE_VAR.set(_ANIMATION_VOID_STATE_VALUE).toStmt()\n      ])\n    );\n\n    statements.push(\n      _ANIMATION_START_STATE_STYLES_VAR.set(\n        _ANIMATION_STYLES_LOOKUP.key(_ANIMATION_CURRENT_STATE_VAR)\n      ).toDeclStmt());\n\n    statements.push(\n      _ANIMATION_FINAL_STATE_STYLES_VAR.set(\n        _ANIMATION_STYLES_LOOKUP.key(_ANIMATION_NEXT_STATE_VAR)\n      ).toDeclStmt());\n\n    // before we start any animation we want to clear out the starting\n    // styles from the element's style property (since they were placed\n    // there at the end of the last animation\n    statements.push(\n      _ANIMATION_FACTORY_RENDERER_VAR.callMethod('setElementStyles', [\n        _ANIMATION_FACTORY_ELEMENT_VAR,\n        _ANIMATION_STYLE_UTIL.callMethod('clearStyles', [_ANIMATION_START_STATE_STYLES_VAR]),\n      ]).toStmt());\n\n    ListWrapper.addAll(statements, transitionStatements);\n\n    // in the situation where a any to any state transition (* => *) has\n    // not occurred then we should create a NoOp player so that the onDone\n    // callback can be used for tracking\n    if (!context.fullAnyStateDetected) {\n      statements.push(\n        new o.IfStmt(_ANIMATION_PLAYER_VAR.equals(o.NULL_EXPR), [\n          _ANIMATION_PLAYER_VAR.set(\n            o.importExpr(Identifiers.NoOpAnimationPlayer).instantiate([])\n          ).toStmt()\n        ]));\n    }\n\n    // once complete we want to apply the styles on the element\n    // since the destination state's values should persist once\n    // the animation sequence has completed.\n    statements.push(\n      _ANIMATION_PLAYER_VAR.callMethod('onDone', [\n        o.fn([], [\n          _ANIMATION_FACTORY_RENDERER_VAR.callMethod('setElementStyles', [\n            _ANIMATION_FACTORY_ELEMENT_VAR,\n            _ANIMATION_STYLE_UTIL.callMethod('balanceStyles', [\n              _ANIMATION_START_STATE_STYLES_VAR,\n              _ANIMATION_FINAL_STATE_STYLES_VAR\n            ])\n          ]).toStmt()\n        ])\n      ]).toStmt());\n\n    statements.push(\n      _ANIMATION_FACTORY_VIEW_VAR.callMethod('registerActiveAnimation', [_ANIMATION_PLAYER_VAR]).toStmt());\n\n    statements.push(\n      _ANIMATION_PLAYER_VAR.callMethod('play', []).toStmt());\n\n    statements.push(new o.ReturnStatement(_ANIMATION_PLAYER_VAR));\n\n    return o.fn([\n      new o.FnParam(_ANIMATION_FACTORY_VIEW_VAR.name, o.importType(Identifiers.AppView)),\n      new o.FnParam(_ANIMATION_FACTORY_ELEMENT_VAR.name, o.DYNAMIC_TYPE),\n      new o.FnParam(_ANIMATION_CURRENT_STATE_VAR.name, o.DYNAMIC_TYPE),\n      new o.FnParam(_ANIMATION_NEXT_STATE_VAR.name, o.DYNAMIC_TYPE)\n    ], statements);\n  }\n\n  build(ast: AnimationAst): CompiledAnimation {\n    var context = new _AnimationBuilderContext();\n    var fnStatement = ast.visit(this, context).toDeclStmt(this.factoryName);\n    var fnVariable = o.variable(this.factoryName);\n    return new CompiledAnimation(this.animationName, fnStatement, fnVariable);\n  }\n}\n\nclass _AnimationBuilderContext {\n  stateMap = new _AnimationBuilderStateMap();\n\n  finalAnimateStepAst;\n  fullAnyStateDetected = false;\n  styleState: _AnimationStyleStepState;\n}\n\nclass _AnimationBuilderStateMap {\n  private _states: {[key: string]: {[prop: string]: string|number}} = {};\n  get states() { return this._states; }\n  registerState(name: string, value: {[prop: string]: string|number} = null): void {\n    var existingEntry = this._states[name];\n    if (isBlank(existingEntry)) {\n      this._states[name] = value;\n    }\n  }\n}\n\nfunction _compareToAnimationStateExpr(value: o.Expression, animationState: string): o.Expression {\n  var compareValue = animationState == EMPTY_STATE ? _ANIMATION_VOID_STATE_VALUE : o.literal(animationState);\n  return value.equals(compareValue);\n}\n\ninterface DecoratorInvocation {\n  type: Function;\n  args?: any[];\n}\n"]}