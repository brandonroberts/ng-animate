{"version":3,"file":"animation_style_util.js","sourceRoot":"","sources":["../../../../../../modules/@angular/core/src/animation/animation_style_util.ts"],"names":[],"mappings":"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","sourcesContent":["import {isPresent, isArray} from '../facade/lang';\nimport {ListWrapper, StringMapWrapper} from '../facade/collection';\nimport {AUTO_STYLE} from './metadata';\nimport {FILL_STYLE_FLAG} from '../animation/animation_constants';\n\nexport class AnimationStyleUtil {\n  static balanceStyles(previousStyles: {[key: string]: string|number},\n                       newStyles: {[key: string]: string|number},\n                       nullValue = null): {[key: string]: string|number} {\n    var finalStyles: {[key: string]: string|number} = {};\n\n    StringMapWrapper.forEach(newStyles, (value, prop) => {\n      finalStyles[prop] = value;\n    });\n\n    StringMapWrapper.forEach(previousStyles, (value, prop) => {\n      if (!isPresent(finalStyles[prop])) {\n        finalStyles[prop] = nullValue;\n      }\n    });\n\n    return finalStyles;\n  }\n  static balanceKeyframes(collectedStyles: {[key: string]: string|number},\n                          finalStateStyles: {[key: string]: string|number},\n                          keyframes: any[]): any[] {\n    var limit = keyframes.length - 1;\n    var firstKeyframe = keyframes[0];\n\n    // phase 1: copy all the styles from the first keyframe into the lookup map\n    var flatenedFirstKeyframeStyles = {};\n    var keyframeCollectedStyles = {};\n    var extraFirstKeyframeStyles = {};\n    var hasExtraFirstStyles = false;\n    StringMapWrapper.forEach(collectedStyles, (value, prop) => {\n      keyframeCollectedStyles[prop] = value;\n      flatenedFirstKeyframeStyles[prop] = value;\n      extraFirstKeyframeStyles[prop] = value;\n      hasExtraFirstStyles = true;\n    });\n    firstKeyframe.styles.styles.forEach(entry => {\n      StringMapWrapper.forEach(entry, (value, prop) => {\n        keyframeCollectedStyles[prop] = value;\n        flatenedFirstKeyframeStyles[prop] = value;\n      });\n    });\n\n    // phase 2: normalize the final keyframe\n    var finalKeyframe = keyframes[limit];\n    finalKeyframe.styles.styles.push(finalStateStyles);\n\n    var flatenedFinalKeyframeStyles = _flattenStyles(finalKeyframe.styles.styles);\n    var extraFinalKeyframeStyles = {};\n    var hasExtraFinalStyles = false;\n    StringMapWrapper.forEach(keyframeCollectedStyles, (value, prop) => {\n      if (!isPresent(flatenedFinalKeyframeStyles[prop])) {\n        extraFinalKeyframeStyles[prop] = AUTO_STYLE;\n        hasExtraFinalStyles = true;\n      }\n    });\n\n    if (hasExtraFinalStyles) {\n      finalKeyframe.styles.styles.push(extraFinalKeyframeStyles);\n    }\n\n    StringMapWrapper.forEach(flatenedFinalKeyframeStyles, (value, prop) => {\n      if (!isPresent(flatenedFirstKeyframeStyles[prop])) {\n        extraFirstKeyframeStyles[prop] = AUTO_STYLE;\n        hasExtraFirstStyles = true;\n      }\n    });\n\n    if (hasExtraFirstStyles) {\n      firstKeyframe.styles.styles.push(extraFirstKeyframeStyles);\n    }\n\n    return keyframes;\n  }\n\n  static clearStyles(styles: {[key: string]: string|number}): {[key: string]: string|number} {\n    var finalStyles: {[key: string]: string|number} = {};\n    StringMapWrapper.keys(styles).forEach(key => {\n      finalStyles[key] = null;\n    });\n    return finalStyles;\n  }\n\n  static collectAndResolveStyles(collection: {[key: string]: string|number}, newStyles: {[key: string]: string|number}[]) {\n    newStyles.forEach(entry => {\n      StringMapWrapper.forEach(entry, (value, prop) => {\n        if (value == FILL_STYLE_FLAG) {\n          value = collection[prop];\n          if (!isPresent(value)) {\n            value = AUTO_STYLE;\n          }\n          entry[prop] = value;\n        }\n        collection[prop] = value;\n      });\n    });\n    return newStyles;\n  }\n}\n\nfunction _flattenStyles(styles: {[key: string]: string|number}[]) {\n  var finalStyles = {};\n  styles.forEach(entry => {\n    StringMapWrapper.forEach(entry, (value, prop) => {\n      finalStyles[prop] = value;\n    });\n  });\n  return finalStyles;\n}\n\ninterface DecoratorInvocation {\n  type: Function;\n  args?: any[];\n}\n"]}