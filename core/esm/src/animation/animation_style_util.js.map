{"version":3,"file":"animation_style_util.js","sourceRoot":"","sources":["../../../../../../modules/@angular/core/src/animation/animation_style_util.ts"],"names":[],"mappings":"OAAO,EAAC,SAAS,EAAU,MAAM,gBAAgB;OAC1C,EAAC,WAAW,EAAE,gBAAgB,EAAC,MAAM,sBAAsB;OAC3D,EAAC,UAAU,EAAC,MAAM,YAAY;OAC9B,EAAC,eAAe,EAAC,MAAM,uBAAuB;AAErD;IACE,OAAO,aAAa,CAAC,cAA8C,EAC9C,SAAyC,EACzC,SAAS,GAAG,IAAI;QACnC,IAAI,WAAW,GAAmC,EAAE,CAAC;QAErD,gBAAgB,CAAC,OAAO,CAAC,SAAS,EAAE,CAAC,KAAK,EAAE,IAAI;YAC9C,WAAW,CAAC,IAAI,CAAC,GAAG,KAAK,CAAC;QAC5B,CAAC,CAAC,CAAC;QAEH,gBAAgB,CAAC,OAAO,CAAC,cAAc,EAAE,CAAC,KAAK,EAAE,IAAI;YACnD,EAAE,CAAC,CAAC,CAAC,SAAS,CAAC,WAAW,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC,CAAC;gBAClC,WAAW,CAAC,IAAI,CAAC,GAAG,SAAS,CAAC;YAChC,CAAC;QACH,CAAC,CAAC,CAAC;QAEH,MAAM,CAAC,WAAW,CAAC;IACrB,CAAC;IACD,OAAO,gBAAgB,CAAC,eAA+C,EAC/C,gBAAgD,EAChD,SAAgB;QACtC,IAAI,KAAK,GAAG,SAAS,CAAC,MAAM,GAAG,CAAC,CAAC;QACjC,IAAI,aAAa,GAAG,SAAS,CAAC,CAAC,CAAC,CAAC;QAEjC,2EAA2E;QAC3E,IAAI,2BAA2B,GAAG,kBAAkB,CAAC,aAAa,CAAC,aAAa,CAAC,MAAM,CAAC,MAAM,CAAC,CAAC;QAEhG,IAAI,wBAAwB,GAAG,EAAE,CAAC;QAClC,IAAI,mBAAmB,GAAG,KAAK,CAAC;QAChC,gBAAgB,CAAC,OAAO,CAAC,eAAe,EAAE,CAAC,KAAK,EAAE,IAAI;YACpD,6DAA6D;YAC7D,wBAAwB;YACxB,EAAE,CAAC,CAAC,CAAC,2BAA2B,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC;gBACvC,2BAA2B,CAAC,IAAI,CAAC,GAAG,KAAK,CAAC;gBAC1C,wBAAwB,CAAC,IAAI,CAAC,GAAG,KAAK,CAAC;gBACvC,mBAAmB,GAAG,IAAI,CAAC;YAC7B,CAAC;QACH,CAAC,CAAC,CAAC;QAEH,IAAI,uBAAuB,GAAG,gBAAgB,CAAC,KAAK,CAAC,EAAE,EAAE,2BAA2B,CAAC,CAAC;QAEtF,wCAAwC;QACxC,IAAI,aAAa,GAAG,SAAS,CAAC,KAAK,CAAC,CAAC;QACrC,WAAW,CAAC,MAAM,CAAC,aAAa,CAAC,MAAM,CAAC,MAAM,EAAE,CAAC,EAAE,gBAAgB,CAAC,CAAC;QAErE,IAAI,2BAA2B,GAAG,kBAAkB,CAAC,aAAa,CAAC,aAAa,CAAC,MAAM,CAAC,MAAM,CAAC,CAAC;QAChG,IAAI,wBAAwB,GAAG,EAAE,CAAC;QAClC,IAAI,mBAAmB,GAAG,KAAK,CAAC;QAChC,gBAAgB,CAAC,OAAO,CAAC,uBAAuB,EAAE,CAAC,KAAK,EAAE,IAAI;YAC5D,EAAE,CAAC,CAAC,CAAC,SAAS,CAAC,2BAA2B,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC,CAAC;gBAClD,wBAAwB,CAAC,IAAI,CAAC,GAAG,UAAU,CAAC;gBAC5C,mBAAmB,GAAG,IAAI,CAAC;YAC7B,CAAC;QACH,CAAC,CAAC,CAAC;QAEH,EAAE,CAAC,CAAC,mBAAmB,CAAC,CAAC,CAAC;YACxB,aAAa,CAAC,MAAM,CAAC,MAAM,CAAC,IAAI,CAAC,wBAAwB,CAAC,CAAC;QAC7D,CAAC;QAED,gBAAgB,CAAC,OAAO,CAAC,2BAA2B,EAAE,CAAC,KAAK,EAAE,IAAI;YAChE,EAAE,CAAC,CAAC,CAAC,SAAS,CAAC,2BAA2B,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC,CAAC;gBAClD,wBAAwB,CAAC,IAAI,CAAC,GAAG,UAAU,CAAC;gBAC5C,mBAAmB,GAAG,IAAI,CAAC;YAC7B,CAAC;QACH,CAAC,CAAC,CAAC;QAEH,EAAE,CAAC,CAAC,mBAAmB,CAAC,CAAC,CAAC;YACxB,aAAa,CAAC,MAAM,CAAC,MAAM,CAAC,IAAI,CAAC,wBAAwB,CAAC,CAAC;QAC7D,CAAC;QAED,MAAM,CAAC,SAAS,CAAC;IACnB,CAAC;IAED,OAAO,WAAW,CAAC,MAAsC;QACvD,IAAI,WAAW,GAAmC,EAAE,CAAC;QACrD,gBAAgB,CAAC,IAAI,CAAC,MAAM,CAAC,CAAC,OAAO,CAAC,GAAG;YACvC,WAAW,CAAC,GAAG,CAAC,GAAG,IAAI,CAAC;QAC1B,CAAC,CAAC,CAAC;QACH,MAAM,CAAC,WAAW,CAAC;IACrB,CAAC;IAED,OAAO,uBAAuB,CAAC,UAA0C,EAAE,MAAwC;QACjH,MAAM,CAAC,MAAM,CAAC,GAAG,CAAC,KAAK;YACrB,IAAI,SAAS,GAAG,EAAE,CAAC;YACnB,gBAAgB,CAAC,OAAO,CAAC,KAAK,EAAE,CAAC,KAAK,EAAE,IAAI;gBAC1C,EAAE,CAAC,CAAC,KAAK,IAAI,eAAe,CAAC,CAAC,CAAC;oBAC7B,KAAK,GAAG,UAAU,CAAC,IAAI,CAAC,CAAC;oBACzB,EAAE,CAAC,CAAC,CAAC,SAAS,CAAC,KAAK,CAAC,CAAC,CAAC,CAAC;wBACtB,KAAK,GAAG,UAAU,CAAC;oBACrB,CAAC;gBACH,CAAC;gBACD,UAAU,CAAC,IAAI,CAAC,GAAG,KAAK,CAAC;gBACzB,SAAS,CAAC,IAAI,CAAC,GAAG,KAAK,CAAC;YAC1B,CAAC,CAAC,CAAC;YACH,MAAM,CAAC,SAAS,CAAC;QACnB,CAAC,CAAC,CAAC;IACL,CAAC;IAED,OAAO,aAAa,CAAC,MAAwC;QAC3D,IAAI,WAAW,GAAG,EAAE,CAAC;QACrB,MAAM,CAAC,OAAO,CAAC,KAAK;YAClB,gBAAgB,CAAC,OAAO,CAAC,KAAK,EAAE,CAAC,KAAK,EAAE,IAAI;gBAC1C,WAAW,CAAC,IAAI,CAAC,GAAG,KAAK,CAAC;YAC5B,CAAC,CAAC,CAAC;QACL,CAAC,CAAC,CAAC;QACH,MAAM,CAAC,WAAW,CAAC;IACrB,CAAC;AACH,CAAC;AAAA","sourcesContent":["import {isPresent, isArray} from '../facade/lang';\nimport {ListWrapper, StringMapWrapper} from '../facade/collection';\nimport {AUTO_STYLE} from './metadata';\nimport {FILL_STYLE_FLAG} from './animation_constants';\n\nexport class AnimationStyleUtil {\n  static balanceStyles(previousStyles: {[key: string]: string|number},\n                       newStyles: {[key: string]: string|number},\n                       nullValue = null): {[key: string]: string|number} {\n    var finalStyles: {[key: string]: string|number} = {};\n\n    StringMapWrapper.forEach(newStyles, (value, prop) => {\n      finalStyles[prop] = value;\n    });\n\n    StringMapWrapper.forEach(previousStyles, (value, prop) => {\n      if (!isPresent(finalStyles[prop])) {\n        finalStyles[prop] = nullValue;\n      }\n    });\n\n    return finalStyles;\n  }\n  static balanceKeyframes(collectedStyles: {[key: string]: string|number},\n                          finalStateStyles: {[key: string]: string|number},\n                          keyframes: any[]): any[] {\n    var limit = keyframes.length - 1;\n    var firstKeyframe = keyframes[0];\n\n    // phase 1: copy all the styles from the first keyframe into the lookup map\n    var flatenedFirstKeyframeStyles = AnimationStyleUtil.flattenStyles(firstKeyframe.styles.styles);\n\n    var extraFirstKeyframeStyles = {};\n    var hasExtraFirstStyles = false;\n    StringMapWrapper.forEach(collectedStyles, (value, prop) => {\n      // if the style is already defined in the first keyframe then\n      // we do not replace it.\n      if (!flatenedFirstKeyframeStyles[prop]) {\n        flatenedFirstKeyframeStyles[prop] = value;\n        extraFirstKeyframeStyles[prop] = value;\n        hasExtraFirstStyles = true;\n      }\n    });\n\n    var keyframeCollectedStyles = StringMapWrapper.merge({}, flatenedFirstKeyframeStyles);\n\n    // phase 2: normalize the final keyframe\n    var finalKeyframe = keyframes[limit];\n    ListWrapper.insert(finalKeyframe.styles.styles, 0, finalStateStyles);\n\n    var flatenedFinalKeyframeStyles = AnimationStyleUtil.flattenStyles(finalKeyframe.styles.styles);\n    var extraFinalKeyframeStyles = {};\n    var hasExtraFinalStyles = false;\n    StringMapWrapper.forEach(keyframeCollectedStyles, (value, prop) => {\n      if (!isPresent(flatenedFinalKeyframeStyles[prop])) {\n        extraFinalKeyframeStyles[prop] = AUTO_STYLE;\n        hasExtraFinalStyles = true;\n      }\n    });\n\n    if (hasExtraFinalStyles) {\n      finalKeyframe.styles.styles.push(extraFinalKeyframeStyles);\n    }\n\n    StringMapWrapper.forEach(flatenedFinalKeyframeStyles, (value, prop) => {\n      if (!isPresent(flatenedFirstKeyframeStyles[prop])) {\n        extraFirstKeyframeStyles[prop] = AUTO_STYLE;\n        hasExtraFirstStyles = true;\n      }\n    });\n\n    if (hasExtraFirstStyles) {\n      firstKeyframe.styles.styles.push(extraFirstKeyframeStyles);\n    }\n\n    return keyframes;\n  }\n\n  static clearStyles(styles: {[key: string]: string|number}): {[key: string]: string|number} {\n    var finalStyles: {[key: string]: string|number} = {};\n    StringMapWrapper.keys(styles).forEach(key => {\n      finalStyles[key] = null;\n    });\n    return finalStyles;\n  }\n\n  static collectAndResolveStyles(collection: {[key: string]: string|number}, styles: {[key: string]: string|number}[]) {\n    return styles.map(entry => {\n      var stylesObj = {};\n      StringMapWrapper.forEach(entry, (value, prop) => {\n        if (value == FILL_STYLE_FLAG) {\n          value = collection[prop];\n          if (!isPresent(value)) {\n            value = AUTO_STYLE;\n          }\n        }\n        collection[prop] = value;\n        stylesObj[prop] = value;\n      });\n      return stylesObj;\n    });\n  }\n\n  static flattenStyles(styles: {[key: string]: string|number}[]) {\n    var finalStyles = {};\n    styles.forEach(entry => {\n      StringMapWrapper.forEach(entry, (value, prop) => {\n        finalStyles[prop] = value;\n      });\n    });\n    return finalStyles;\n  }\n}\n\ninterface DecoratorInvocation {\n  type: Function;\n  args?: any[];\n}\n"]}