{"version":3,"file":"animation_style_util.js","sourceRoot":"","sources":["../../../../../modules/@angular/core/src/animation/animation_style_util.ts"],"names":[],"mappings":"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","sourcesContent":["import {isPresent, isArray} from '../facade/lang';\nimport {ListWrapper, StringMapWrapper} from '../facade/collection';\nimport {AUTO_STYLE} from './metadata';\nimport {FILL_STYLE_FLAG} from './animation_constants';\n\nexport class AnimationStyleUtil {\n  static balanceStyles(previousStyles: {[key: string]: string|number},\n                       newStyles: {[key: string]: string|number},\n                       nullValue = null): {[key: string]: string|number} {\n    var finalStyles: {[key: string]: string|number} = {};\n\n    StringMapWrapper.forEach(newStyles, (value, prop) => {\n      finalStyles[prop] = value;\n    });\n\n    StringMapWrapper.forEach(previousStyles, (value, prop) => {\n      if (!isPresent(finalStyles[prop])) {\n        finalStyles[prop] = nullValue;\n      }\n    });\n\n    return finalStyles;\n  }\n  static balanceKeyframes(collectedStyles: {[key: string]: string|number},\n                          finalStateStyles: {[key: string]: string|number},\n                          keyframes: any[]): any[] {\n    var limit = keyframes.length - 1;\n    var firstKeyframe = keyframes[0];\n\n    // phase 1: copy all the styles from the first keyframe into the lookup map\n    var flatenedFirstKeyframeStyles = AnimationStyleUtil.flattenStyles(firstKeyframe.styles.styles);\n\n    var extraFirstKeyframeStyles = {};\n    var hasExtraFirstStyles = false;\n    StringMapWrapper.forEach(collectedStyles, (value, prop) => {\n      // if the style is already defined in the first keyframe then\n      // we do not replace it.\n      if (!flatenedFirstKeyframeStyles[prop]) {\n        flatenedFirstKeyframeStyles[prop] = value;\n        extraFirstKeyframeStyles[prop] = value;\n        hasExtraFirstStyles = true;\n      }\n    });\n\n    var keyframeCollectedStyles = StringMapWrapper.merge({}, flatenedFirstKeyframeStyles);\n\n    // phase 2: normalize the final keyframe\n    var finalKeyframe = keyframes[limit];\n    ListWrapper.insert(finalKeyframe.styles.styles, 0, finalStateStyles);\n\n    var flatenedFinalKeyframeStyles = AnimationStyleUtil.flattenStyles(finalKeyframe.styles.styles);\n    var extraFinalKeyframeStyles = {};\n    var hasExtraFinalStyles = false;\n    StringMapWrapper.forEach(keyframeCollectedStyles, (value, prop) => {\n      if (!isPresent(flatenedFinalKeyframeStyles[prop])) {\n        extraFinalKeyframeStyles[prop] = AUTO_STYLE;\n        hasExtraFinalStyles = true;\n      }\n    });\n\n    if (hasExtraFinalStyles) {\n      finalKeyframe.styles.styles.push(extraFinalKeyframeStyles);\n    }\n\n    StringMapWrapper.forEach(flatenedFinalKeyframeStyles, (value, prop) => {\n      if (!isPresent(flatenedFirstKeyframeStyles[prop])) {\n        extraFirstKeyframeStyles[prop] = AUTO_STYLE;\n        hasExtraFirstStyles = true;\n      }\n    });\n\n    if (hasExtraFirstStyles) {\n      firstKeyframe.styles.styles.push(extraFirstKeyframeStyles);\n    }\n\n    return keyframes;\n  }\n\n  static clearStyles(styles: {[key: string]: string|number}): {[key: string]: string|number} {\n    var finalStyles: {[key: string]: string|number} = {};\n    StringMapWrapper.keys(styles).forEach(key => {\n      finalStyles[key] = null;\n    });\n    return finalStyles;\n  }\n\n  static collectAndResolveStyles(collection: {[key: string]: string|number}, styles: {[key: string]: string|number}[]) {\n    return styles.map(entry => {\n      var stylesObj = {};\n      StringMapWrapper.forEach(entry, (value, prop) => {\n        if (value == FILL_STYLE_FLAG) {\n          value = collection[prop];\n          if (!isPresent(value)) {\n            value = AUTO_STYLE;\n          }\n        }\n        collection[prop] = value;\n        stylesObj[prop] = value;\n      });\n      return stylesObj;\n    });\n  }\n\n  static flattenStyles(styles: {[key: string]: string|number}[]) {\n    var finalStyles = {};\n    styles.forEach(entry => {\n      StringMapWrapper.forEach(entry, (value, prop) => {\n        finalStyles[prop] = value;\n      });\n    });\n    return finalStyles;\n  }\n}\n\ninterface DecoratorInvocation {\n  type: Function;\n  args?: any[];\n}\n"]}