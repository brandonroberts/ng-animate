{"version":3,"file":"serializer.js","sourceRoot":"","sources":["../../../../../../../modules/@angular/platform-browser/src/web_workers/shared/serializer.ts"],"names":[],"mappings":"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","sourcesContent":["import {Type, isArray, isPresent, serializeEnum} from '../../../src/facade/lang';\nimport {BaseException} from '../../../src/facade/exceptions';\nimport {Map, StringMapWrapper, MapWrapper} from '../../../src/facade/collection';\nimport {RenderComponentType, Injectable, ViewEncapsulation} from '@angular/core';\nimport {VIEW_ENCAPSULATION_VALUES} from '../../../core_private';\nimport {RenderStore} from './render_store';\nimport {LocationType} from './serialized_types';\n\n// PRIMITIVE is any type that does not need to be serialized (string, number, boolean)\n// We set it to String so that it is considered a Type.\nexport const PRIMITIVE: Type = /*@ts2dart_const*/ String;\nexport class Serializer {\n  constructor(private _renderStore: RenderStore) {}\n\n  serialize(obj: any, type: any): Object {\n    if (!isPresent(obj)) {\n      return null;\n    }\n    if (isArray(obj)) {\n      return (<any[]>obj).map(v => this.serialize(v, type));\n    }\n    if (type == PRIMITIVE) {\n      return obj;\n    }\n    if (type == RenderStoreObject) {\n      return this._renderStore.serialize(obj);\n    } else if (type === RenderComponentType) {\n      return this._serializeRenderComponentType(obj);\n    } else if (type === ViewEncapsulation) {\n      return serializeEnum(obj);\n    } else if (type === LocationType) {\n      return this._serializeLocation(obj);\n    } else {\n      throw new BaseException(\"No serializer for \" + type.toString());\n    }\n  }\n\n  deserialize(map: any, type: any, data?: any): any {\n    if (!isPresent(map)) {\n      return null;\n    }\n    if (isArray(map)) {\n      var obj: any[] = [];\n      (<any[]>map).forEach(val => obj.push(this.deserialize(val, type, data)));\n      return obj;\n    }\n    if (type == PRIMITIVE) {\n      return map;\n    }\n\n    if (type == RenderStoreObject) {\n      return this._renderStore.deserialize(map);\n    } else if (type === RenderComponentType) {\n      return this._deserializeRenderComponentType(map);\n    } else if (type === ViewEncapsulation) {\n      return VIEW_ENCAPSULATION_VALUES[map];\n    } else if (type === LocationType) {\n      return this._deserializeLocation(map);\n    } else {\n      throw new BaseException(\"No deserializer for \" + type.toString());\n    }\n  }\n\n  mapToObject(map: Map<string, any>, type?: Type): Object {\n    var object = {};\n    var serialize = isPresent(type);\n\n    map.forEach((value, key) => {\n      if (serialize) {\n        object[key] = this.serialize(value, type);\n      } else {\n        object[key] = value;\n      }\n    });\n    return object;\n  }\n\n  /*\n   * Transforms a Javascript object (StringMap) into a Map<string, V>\n   * If the values need to be deserialized pass in their type\n   * and they will be deserialized before being placed in the map\n   */\n  objectToMap(obj: {[key: string]: any}, type?: Type, data?: any): Map<string, any> {\n    if (isPresent(type)) {\n      var map = new Map<string, any>();\n      StringMapWrapper.forEach(obj,\n                               (val, key) => { map.set(key, this.deserialize(val, type, data)); });\n      return map;\n    } else {\n      return MapWrapper.createFromStringMap(obj);\n    }\n  }\n\n  private _serializeLocation(loc: LocationType): Object {\n    return {\n      'href': loc.href,\n      'protocol': loc.protocol,\n      'host': loc.host,\n      'hostname': loc.hostname,\n      'port': loc.port,\n      'pathname': loc.pathname,\n      'search': loc.search,\n      'hash': loc.hash,\n      'origin': loc.origin\n    };\n  }\n\n  private _deserializeLocation(loc: {[key: string]: any}): LocationType {\n    return new LocationType(loc['href'], loc['protocol'], loc['host'], loc['hostname'], loc['port'],\n                            loc['pathname'], loc['search'], loc['hash'], loc['origin']);\n  }\n\n  private _serializeRenderComponentType(obj: RenderComponentType): Object {\n    return {\n      'id': obj.id,\n      'templateUrl': obj.templateUrl,\n      'slotCount': obj.slotCount,\n      'encapsulation': this.serialize(obj.encapsulation, ViewEncapsulation),\n      'styles': this.serialize(obj.styles, PRIMITIVE)\n    };\n  }\n\n  private _deserializeRenderComponentType(map: {[key: string]: any}): RenderComponentType {\n    return new RenderComponentType(map['id'], map['templateUrl'], map['slotCount'],\n                                   this.deserialize(map['encapsulation'], ViewEncapsulation),\n                                   this.deserialize(map['styles'], PRIMITIVE));\n  }\nstatic decorators: DecoratorInvocation[] = [\n{ type: Injectable },\n];\nstatic ctorParameters: {type: Function, decorators?: DecoratorInvocation[]}[] = [\n{type: RenderStore, },\n];\n}\n\n\nexport class RenderStoreObject {}\n\ninterface DecoratorInvocation {\n  type: Function;\n  args?: any[];\n}\n"]}