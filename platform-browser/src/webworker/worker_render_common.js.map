{"version":3,"file":"worker_render_common.js","sourceRoot":"","sources":["../../../../../modules/@angular/platform-browser/src/webworker/worker_render_common.ts"],"names":[],"mappings":"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","sourcesContent":["import {IS_DART} from '../../src/facade/lang';\nimport {MessageBus} from '../web_workers/shared/message_bus';\nimport {NgZone, Provider, Injector, OpaqueToken, Testability} from '@angular/core';\nimport {wtfInit} from '../../core_private';\nimport {\n  ExceptionHandler,\n  APPLICATION_COMMON_PROVIDERS,\n  PLATFORM_COMMON_PROVIDERS,\n  RootRenderer,\n  PLATFORM_INITIALIZER\n} from '@angular/core';\nimport {getDOM} from '../dom/dom_adapter';\nimport {DomEventsPlugin} from '../dom/events/dom_events';\nimport {KeyEventsPlugin} from '../dom/events/key_events';\nimport {HammerGesturesPlugin} from '../dom/events/hammer_gestures';\nimport {DOCUMENT} from '../dom/dom_tokens';\nimport {DomRootRenderer, DomRootRenderer_} from '../dom/dom_renderer';\nimport {DomSharedStylesHost, SharedStylesHost} from '../dom/shared_styles_host';\nimport {BrowserGetTestability} from '../browser/testability';\nimport {BrowserDomAdapter} from '../browser/browser_adapter';\nimport {MessageBasedRenderer} from '../web_workers/ui/renderer';\nimport {\n  ServiceMessageBrokerFactory,\n  ServiceMessageBrokerFactory_\n} from '../web_workers/shared/service_message_broker';\nimport {\n  ClientMessageBrokerFactory,\n  ClientMessageBrokerFactory_\n} from '../web_workers/shared/client_message_broker';\nimport {Serializer} from '../web_workers/shared/serializer';\nimport {ON_WEB_WORKER} from '../web_workers/shared/api';\nimport {RenderStore} from '../web_workers/shared/render_store';\nimport {HAMMER_GESTURE_CONFIG, HammerGestureConfig} from '../dom/events/hammer_gestures';\nimport {EventManager, EVENT_MANAGER_PLUGINS} from '../dom/events/event_manager';\nimport {BROWSER_SANITIZATION_PROVIDERS} from '../browser_common';\n\nexport const WORKER_SCRIPT: OpaqueToken = /*@ts2dart_const*/ new OpaqueToken(\"WebWorkerScript\");\n\n/**\n * A multiple providers used to automatically call the `start()` method after the service is\n * created.\n *\n * TODO(vicb): create an interface for startable services to implement\n */\nexport const WORKER_RENDER_STARTABLE_MESSAGING_SERVICE =\n    /*@ts2dart_const*/ new OpaqueToken('WorkerRenderStartableMsgService');\n\nexport const WORKER_RENDER_PLATFORM_MARKER =\n    /*@ts2dart_const*/ new OpaqueToken('WorkerRenderPlatformMarker');\n\nexport const WORKER_RENDER_PLATFORM_PROVIDERS: Array<any /*Type | Provider | any[]*/> = /*@ts2dart_const*/[\n  PLATFORM_COMMON_PROVIDERS,\n  /*@ts2dart_const*/ (/* @ts2dart_Provider */ {provide: WORKER_RENDER_PLATFORM_MARKER, useValue: true}),\n  /* @ts2dart_Provider */ {provide: PLATFORM_INITIALIZER, useValue: initWebWorkerRenderPlatform, multi: true}\n];\n\nexport const WORKER_RENDER_APPLICATION_COMMON_PROVIDERS: Array<any /*Type | Provider | any[]*/> =\n    /*@ts2dart_const*/[\n      APPLICATION_COMMON_PROVIDERS,\n      MessageBasedRenderer,\n      /* @ts2dart_Provider */ {provide: WORKER_RENDER_STARTABLE_MESSAGING_SERVICE, useExisting: MessageBasedRenderer, multi: true},\n      BROWSER_SANITIZATION_PROVIDERS,\n      /* @ts2dart_Provider */ {provide: ExceptionHandler, useFactory: _exceptionHandler, deps: []},\n      /* @ts2dart_Provider */ {provide: DOCUMENT, useFactory: _document, deps: []},\n      // TODO(jteplitz602): Investigate if we definitely need EVENT_MANAGER on the render thread\n      // #5298\n      /* @ts2dart_Provider */ {provide: EVENT_MANAGER_PLUGINS, useClass: DomEventsPlugin, multi: true},\n      /* @ts2dart_Provider */ {provide: EVENT_MANAGER_PLUGINS, useClass: KeyEventsPlugin, multi: true},\n      /* @ts2dart_Provider */ {provide: EVENT_MANAGER_PLUGINS, useClass: HammerGesturesPlugin, multi: true},\n      /* @ts2dart_Provider */ {provide: HAMMER_GESTURE_CONFIG, useClass: HammerGestureConfig},\n      /* @ts2dart_Provider */ {provide: DomRootRenderer, useClass: DomRootRenderer_},\n      /* @ts2dart_Provider */ {provide: RootRenderer, useExisting: DomRootRenderer},\n      /* @ts2dart_Provider */ {provide: SharedStylesHost, useExisting: DomSharedStylesHost},\n      /* @ts2dart_Provider */ {provide: ServiceMessageBrokerFactory, useClass: ServiceMessageBrokerFactory_},\n      /* @ts2dart_Provider */ {provide: ClientMessageBrokerFactory, useClass: ClientMessageBrokerFactory_},\n      Serializer,\n      /* @ts2dart_Provider */ {provide: ON_WEB_WORKER, useValue: false},\n      RenderStore,\n      DomSharedStylesHost,\n      Testability,\n      EventManager\n    ];\n\nexport function initializeGenericWorkerRenderer(injector: Injector) {\n  var bus = injector.get(MessageBus);\n  let zone = injector.get(NgZone);\n  bus.attachToZone(zone);\n\n  // initialize message services after the bus has been created\n  let services = injector.get(WORKER_RENDER_STARTABLE_MESSAGING_SERVICE);\n  zone.runGuarded(() => { services.forEach((svc) => { svc.start(); }); });\n}\n\nexport function initWebWorkerRenderPlatform(): void {\n  BrowserDomAdapter.makeCurrent();\n  wtfInit();\n  BrowserGetTestability.init();\n}\n\nfunction _exceptionHandler(): ExceptionHandler {\n  return new ExceptionHandler(getDOM(), !IS_DART);\n}\n\nfunction _document(): any {\n  return getDOM().defaultDoc();\n}\n\ninterface DecoratorInvocation {\n  type: Function;\n  args?: any[];\n}\n"]}